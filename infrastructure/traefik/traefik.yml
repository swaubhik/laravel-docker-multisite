# Traefik Static Configuration

# API and Dashboard
api:
  dashboard: true
  insecure: false

# Log configuration
log:
  level: INFO
  filePath: /var/log/traefik/traefik.log
  format: json

# Access log
accessLog:
  filePath: /var/log/traefik/access.log
  format: json
  bufferingSize: 100
  filters:
    statusCodes:
      - "400-599"
    retryAttempts: true
    minDuration: "10ms"

# Entry Points
entryPoints:
  web:
    address: ":80"
    # Disable HTTP to HTTPS redirect for IP-based access
    # http:
    #   redirections:
    #     entryPoint:
    #       to: websecure
    #       scheme: https
    #       permanent: true
  websecure:
    address: ":443"
    http:
      tls:
        certResolver: letsencrypt
      middlewares:
        - security-headers@file
    # Forwarded headers configuration
    forwardedHeaders:
      trustedIPs:
        - "127.0.0.1/32"
        - "10.0.0.0/8"
        - "172.16.0.0/12"
        - "192.168.0.0/16"

# Certificate Resolvers
certificatesResolvers:
  letsencrypt:
    acme:
      email: "sys.admin@cit.ac.in"
      storage: /acme.json
      httpChallenge:
        entryPoint: web
      # Use staging server for testing (uncomment below, comment out above httpChallenge)
      # caServer: https://acme-staging-v02.api.letsencrypt.org/directory

# Docker Provider
providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    exposedByDefault: false
    network: docker_laravel_network
    watch: true
  file:
    directory: /config
    watch: true

# Ping (health check)
ping:
  entryPoint: websecure

# Global settings
global:
  checkNewVersion: false
  sendAnonymousUsage: false
